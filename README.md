# Personal server

This repo is a bunch of docker-compose files that set up a couple of services I use on my personal server.

Nextcloud and Mosquitto in particular permit a significant level of federation.

## ssl-gateway
Uses the fabulous nginx-proxy suite to automate certificate management and SSL offloading

## Nextcloud
Convenient cloud storage with permissions that other people don't seem to have trouble navigating.

## Collabora
libreoffice as a plugin, used on nextcloud. There seems to be a shortage of working examples of collabora/nextcloud/ssl

## Mosquitto
MQTT broker for IoT type shenanigans.
Used for Owntracks and turning the kettle on.

## folio
a basic static site server for blogs etc

## taskd
Taskwarrior sync server, low-nonsense task list that has CLI and android clients. 

# setup and backup

These examples are not perfect, but once the settings are in, they should all load and run with `sudo docker-compose up` without error.  Let me know about any problems there.

The following named docker volumes need to exist on the host machine:
* `ssl-gateway-conf`
* `ssl-gateway-vhost`
* `ssl-gateway-html`
* `ssl-gateway-certs`
* `nextcloud-html`
* `nextcloud-db`
create them with `sudo docker volume create volume_name`

The SSL-gateway volumes are named on the host so that they are accessible by other containers. Mosquitto accesses the certificates directly to encrypt MQTT traffic.  These volumes don't store anything that can't be regenerated easily.

The persistence volumes used by mosquitto mostly just store logs and retained messages.
taskd's persistence data can be regenerated by a single up-to-date client.

The volumes used by nextcloud store all of the nextcloud files, and should absolutely be included in a routine backup.

